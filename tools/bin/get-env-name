#!/usr/bin/env node
const dotenv = require("dotenv");
const prettier = require("prettier");
const [prevEnv, afterEnv] = process.argv.slice(2);

const prev = dotenv.parse(prevEnv);
const after = dotenv.parse(afterEnv);

const names = {};
for (const [k] of Object.entries(after)) {
  // only print changed vars
  if (prev[k] !== after[k]) {
    names[k] = k;
  }
}

const fileContent = `export const AllProjectEnvNames = ${JSON.stringify(
  names,
  null,
  2
)} as const;
export type ProjectEnvName = keyof typeof AllProjectEnvNames;`;

const formatContent = prettier.format(fileContent, {
  parser: "typescript",
  singleQuote: true,
  semi: true,
  tabWidth: 2,
  arrowParens: "avoid",
  trailingComma: "all",
  printWidth: 80,
});

console.log(formatContent);
